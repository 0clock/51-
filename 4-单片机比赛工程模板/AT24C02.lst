C51 COMPILER V9.60.0.0   AT24C02                                                           04/21/2023 13:03:50 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE AT24C02
OBJECT MODULE PLACED IN .\OBJ\AT24C02.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE Library\src\AT24C02.c LARGE OMF2 WARNINGLEVEL(1) OPTIMIZE(8,SPEED) INCDI
                    -R(.\Library\inc;.\USER) PRINT(.\AT24C02.lst) TABS(2) OBJECT(.\OBJ\AT24C02.obj)

line level    source

   1          /*********************************************************************************************************
   2          ** ÎÄ¼þ¹¦ÄÜ £ºAT24C02 Çý¶¯³ÌÐò
   3          ** ÎÄ¼þËµÃ÷ £ºAT24C02µÄµÄÈýÎ»µØÖ·ÏßÈ«²¿½ÓµØ£¬¹ÊÆäµØÖ·Îª0xa0
   4          ** ¹¤³Ì×÷Õß £ºBlue Sky Teams¡ª¡ªZZL
   5          ** ¹¤³Ì°æ±¾ £ºV1.0
   6          *********************************************************************************************************/
   7          
   8          #include"AT24C02.h"
   9          
  10          
  11          /*********************************************************************************************************
  12          ** º¯Êý¹¦ÄÜ £ºIICÆðÊ¼ÐÅºÅ
  13          ** º¯ÊýËµÃ÷ £ºSCLÏßÎª¸ßµçÆ½ÆÚ¼ä£¬SDAÏßÓÉ¸ßµçÆ½ÏòµÍµçÆ½µÄ±ä»¯±íÊ¾ÆðÊ¼ÐÅºÅ
  14          ** Èë¿Ú²ÎÊý £ºÎÞ
  15          ** ³ö¿Ú²ÎÊý £ºÎÞ 
  16          *********************************************************************************************************/
  17          void AT24C02_Start()
  18          {
  19   1        AT24C02_SDA=1;_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();
  20   1        AT24C02_SCL=1;_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();
  21   1        AT24C02_SDA=0;_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();
  22   1      }
  23          /*********************************************************************************************************
  24          ** º¯Êý¹¦ÄÜ £ºIICÖÕÖ¹ÐÅºÅ
  25          ** º¯ÊýËµÃ÷ £ºSCLÏßÎª¸ßµçÆ½ÆÚ¼ä£¬SDAÏßÓÉµÍµçÆ½Ïò¸ßµçÆ½µÄ±ä»¯±íÊ¾ÖÕÖ¹ÐÅºÅ¡£
  26          ** Èë¿Ú²ÎÊý £ºÎÞ
  27          ** ³ö¿Ú²ÎÊý £ºÎÞ 
  28          *********************************************************************************************************/
  29          void AT24C02_Stop() 
  30          {
  31   1        AT24C02_SDA=0;_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();
  32   1        AT24C02_SCL=1;_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();
  33   1        AT24C02_SDA=1;_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();  
  34   1      }
  35          /*********************************************************************************************************
  36          ** º¯Êý¹¦ÄÜ £ºIICÓ¦´ðÐÅºÅ
  37          ** º¯ÊýËµÃ÷ £ºµÈ´ýÓ¦´ð¼´SDAÎªµÍ£¬ÈôµÈ´ýÒ»¶¨Ê±¼ä»¹Ã»Ó¦´ð£¬Ä¬ÈÏÎª½ÓÊÜÍêÁË
  38          ** Èë¿Ú²ÎÊý £ºÎÞ
  39          ** ³ö¿Ú²ÎÊý £ºÎÞ 
  40          *********************************************************************************************************/
  41          void AT24C02_Ack()
  42          {
  43   1        uchar i=0;
  44   1        AT24C02_SCL=1;_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();
  45   1        while((AT24C02_SDA==1)&&(i<250))i++;
  46   1        AT24C02_SCL=0;_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();
  47   1      }
  48          /*********************************************************************************************************
  49          ** º¯Êý¹¦ÄÜ £º·¢ËÍÒ»¸ö×Ö½Ú
  50          ** Èë¿Ú²ÎÊý £ºdat£º´ý·¢ËÍµÄ×Ö½Ú
  51          ** ³ö¿Ú²ÎÊý £ºÎÞ
  52          *********************************************************************************************************/
  53          void AT24C02_Write_Byte(dat)
  54          {
C51 COMPILER V9.60.0.0   AT24C02                                                           04/21/2023 13:03:50 PAGE 2   

  55   1        uchar temp,i;
  56   1        temp=dat;
  57   1        for(i=0;i<8;i++)
  58   1        {
  59   2          temp=temp<<1;
  60   2          AT24C02_SCL=0;_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();
  61   2          AT24C02_SDA=CY;_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();
  62   2          AT24C02_SCL=1;_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();
  63   2        }
  64   1        AT24C02_SCL=0;_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();
  65   1        AT24C02_SDA=1;_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();//ÊÍ·ÅÊý¾Ý×ÜÏß£¬ÒÔ±ãºóÃæµÄÓ
             -¦´ðÐÅºÅ
  66   1      }
  67          /*********************************************************************************************************
  68          ** º¯Êý¹¦ÄÜ £º½ÓÊÕÒ»¸ö×Ö½Ú
  69          ** Èë¿Ú²ÎÊý £ºÎÞ
  70          ** ³ö¿Ú²ÎÊý £ºdat£º½ÓÊÕµ½µÄ×Ö½Ú
  71          *********************************************************************************************************/
  72          uchar AT24C02_Read_Byte()
  73          {
  74   1        uchar dat,i;
  75   1          AT24C02_SCL=0;_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();
  76   1        AT24C02_SDA=1;_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();//ÊÍ·ÅÊý¾Ý×ÜÏß
  77   1        for(i=0;i<8;i++)
  78   1        {
  79   2          AT24C02_SCL=1;_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();
  80   2          dat=(dat<<1)|AT24C02_SDA;_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();
  81   2          AT24C02_SCL=0;_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();
  82   2        }
  83   1        return(dat);
  84   1      }
  85          /*********************************************************************************************************
  86          ** º¯Êý¹¦ÄÜ £ºAT24C02µÄ³õÊ¼»¯º¯Êý
  87          ** º¯ÊýËµÃ÷ £ºAT24C02³õÊ¼»¯Ê±SCL¡¢SDA¾ùÎª¸ßµçÆ½
  88          ** Èë¿Ú²ÎÊý £ºÎÞ
  89          ** ³ö¿Ú²ÎÊý £ºÎÞ 
  90          *********************************************************************************************************/
  91          void AT24C02_Init()
  92          {
  93   1        AT24C02_SCL=1;_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();
  94   1        AT24C02_SDA=1;_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();_nop_();
  95   1      }
  96          /*********************************************************************************************************
  97          ** º¯Êý¹¦ÄÜ £ºËæ»úµØÖ·´æ´¢×Ö½Ú
  98          ** º¯ÊýËµÃ÷ £ºËæ»úÐ´ÈëÒ»¸öµØÖ·£¬½«×Ö½Ú´æÔÚÄÇ¸öµØÖ·ÉÏ
  99          ** Èë¿Ú²ÎÊý £ºdat£º´ý´æ´¢µÄ×Ö½Ú
 100          **            add£º´æ´¢×Ö½ÚµÄµØÖ·
 101          ** ³ö¿Ú²ÎÊý £ºÎÞ 
 102          *********************************************************************************************************/
 103          void AT24C02_Write_Add(uchar dat,uchar add)
 104          {
 105   1        AT24C02_Stop();//ÖÕÖ¹
 106   1        AT24C02_Start();//ÆðÊ¼
 107   1        AT24C02_Write_Byte(0xa0);//´ÓÆ÷¼þµØÖ·£¬¼´½«½øÐÐÐ´
 108   1        AT24C02_Ack();//Ó¦´ð
 109   1        AT24C02_Write_Byte(add);//×Ö½ÚµØÖ·
 110   1        AT24C02_Ack();//Ó¦´ð
 111   1        AT24C02_Write_Byte(dat);//Ð´µÄÊý¾Ý
 112   1        AT24C02_Ack();//Ó¦´ð
 113   1        AT24C02_Stop();//ÖÕÖ¹ 
 114   1      }
 115          /*********************************************************************************************************
C51 COMPILER V9.60.0.0   AT24C02                                                           04/21/2023 13:03:50 PAGE 3   

 116          ** º¯Êý¹¦ÄÜ £ºËæ»úµØÖ·¶ÁÈ¡×Ö½Ú
 117          ** º¯ÊýËµÃ÷ £ºÐ´ÈëÒ»¸öµØÖ·£¬¶ÁÈ¡Õâ¸öµØÖ·ÉÏµÄ×Ö½Ú
 118          ** Èë¿Ú²ÎÊý £º add£º´ý¶ÁÈ¡×Ö½ÚµÄµØÖ·        
 119          ** ³ö¿Ú²ÎÊý £ºÎÞ 
 120          *********************************************************************************************************/
 121          uchar AT24C02_Read_Add(uchar add)
 122          {
 123   1        uchar dat;
 124   1        AT24C02_Stop();//ÖÕÖ¹
 125   1        AT24C02_Start();//ÆðÊ¼
 126   1        AT24C02_Write_Byte(0xa0);//´ÓÆ÷¼þµØÖ·
 127   1        AT24C02_Ack();//Ó¦´ð
 128   1        AT24C02_Write_Byte(add);//×Ö½ÚµØÖ·
 129   1        AT24C02_Ack();//Ó¦´ð
 130   1        AT24C02_Start();//ÆðÊ¼
 131   1        AT24C02_Write_Byte(0xa1);//´ÓÆ÷¼þµØÖ·£¬¼´½«½øÐÐ¶Á
 132   1        AT24C02_Ack();//Ó¦´ð
 133   1        dat=AT24C02_Read_Byte();//¶Á»ØÊý¾Ý
 134   1        AT24C02_Stop();//ÖÕÖ¹
 135   1        return(dat);
 136   1      }
 137          /*********************************************************************************************************
 138          ** º¯Êý¹¦ÄÜ £ºËæ»úµØÖ·¶ÁÈ¡Ò»Ò³
 139          ** º¯ÊýËµÃ÷ £ºÒ³Ð´·½Ê½£¬µØÖ·±ØÐëÂú×ãÒ³·½Ê½£¬²ÅÄÜ±»È«²¿Ð´½øEEPROM£»
 140          **            ÈçµØÖ·ÒªÎª0x00,0x08£¬0x10ÕâÑùÐ´ÈëµÄ8¸ö×Ö½Ú²ÅÄÜÈ«²¿Ð´½øÈ¥£¬·ñÔòÈçÐ´0x01ÔòÐ´ÈëÊý¾Ý×îºóÒ»¸ö½«ÎÞ
             -·¨Ð´½ø£¡
 141          ** Èë¿Ú²ÎÊý £ºadd£º´ý´æ´¢×Ö·û´®µÄµØÖ·
 142          **            dat£º´ý´æ´¢µÄ×Ö·û´®       
 143          ** ³ö¿Ú²ÎÊý £ºÎÞ 
 144          *********************************************************************************************************/
 145          void AT24C02_Write_Page(uchar *dat,uchar add)
 146          {
 147   1        uchar q;
 148   1        AT24C02_Stop();//ÖÕÖ¹
 149   1        AT24C02_Start();
 150   1        AT24C02_Write_Byte(0xa0);
 151   1        AT24C02_Ack();
 152   1        AT24C02_Write_Byte(add);
 153   1        AT24C02_Ack();
 154   1        for(q=0;dat[q]!='\0';q++)
 155   1        {
 156   2          AT24C02_Write_Byte(dat[q]);
 157   2          AT24C02_Ack();
 158   2        }
 159   1        AT24C02_Stop();
 160   1      }
 161          /************************** (C) COPYRIGHT 2011 Blue Sky Teams *****END OF FILE****************************
             -*/   
 162          
 163          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    368    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----       3
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
C51 COMPILER V9.60.0.0   AT24C02                                                           04/21/2023 13:03:50 PAGE 4   

   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
