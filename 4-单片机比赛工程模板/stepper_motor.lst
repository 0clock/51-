C51 COMPILER V9.60.0.0   STEPPER_MOTOR                                                     04/21/2023 13:03:51 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE STEPPER_MOTOR
OBJECT MODULE PLACED IN .\OBJ\stepper_motor.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE Library\src\stepper_motor.c LARGE OMF2 WARNINGLEVEL(1) OPTIMIZE(8,SPEED)
                    - INCDIR(.\Library\inc;.\USER) PRINT(.\stepper_motor.lst) TABS(2) OBJECT(.\OBJ\stepper_motor.obj)

line level    source

   1          
   2          
   3          
   4          #include "stepper_motor.h"
   5          
   6          /*******************************************************************************
   7          * 输    入       : Dir 1:正转   0:倒转  >2:停转
   8          * 输    出       : 无
   9           ，每执行一次转动一定角度，执行间隔时间决定速度，可放在定时中断，改变中断时间
  10          
  11          *******************************************************************************/
  12          void stepper_motor(uchar Dir)
  13          { 
  14   1        static char phase=0;
  15   1        if(Dir<2){
  16   2          switch(phase)
  17   2          {
  18   3          case(0):
  19   3            MOTOA = 1;
  20   3            MOTOB = 0;
  21   3            MOTOC = 0;
  22   3            MOTOD = 0;
  23   3            break;
  24   3      
  25   3          case(1):
  26   3            MOTOA = 0;
  27   3            MOTOB = 1;
  28   3            MOTOC = 0;
  29   3            MOTOD = 0;
  30   3            break;
  31   3      
  32   3          case(2):
  33   3            MOTOA = 0;
  34   3            MOTOB = 0;
  35   3            MOTOC = 1;
  36   3            MOTOD = 0;
  37   3            break;
  38   3      
  39   3          case(3):
  40   3            MOTOA = 0;
  41   3            MOTOB = 0;
  42   3            MOTOC = 0;
  43   3            MOTOD = 1;
  44   3            break;
  45   3          }
  46   2        }else{//停转
  47   2            MOTOA = 0;
  48   2            MOTOB = 0;
  49   2            MOTOC = 0;
  50   2            MOTOD = 0;
  51   2        
  52   2        }
  53   1        if(Dir==1)
  54   1          phase++;
C51 COMPILER V9.60.0.0   STEPPER_MOTOR                                                     04/21/2023 13:03:51 PAGE 2   

  55   1        if(Dir==0)
  56   1          phase--;
  57   1        
  58   1        if(phase>3)
  59   1          phase=0;
  60   1        if(phase<0)
  61   1          phase=3;
  62   1      }
  63          
  64          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    129    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      1    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
