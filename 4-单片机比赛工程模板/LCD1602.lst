C51 COMPILER V9.60.7.0   LCD1602                                                           04/21/2023 17:04:02 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE LCD1602
OBJECT MODULE PLACED IN .\OBJ\LCD1602.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE Library\src\LCD1602.c LARGE OMF2 WARNINGLEVEL(1) OPTIMIZE(8,SPEED) BROWS
                    -E INCDIR(.\Library\inc;.\USER) PRINT(.\LCD1602.lst) TABS(2) OBJECT(.\OBJ\LCD1602.obj)

line level    source

   1          /*********************************************************************************************************
   2          ** ÎÄ¼þ¹¦ÄÜ £ºLCD1602Çý¶¯³ÌÐò
   3          ** ¹¤³Ì×÷Õß £ºBlue Sky Teams¡ª¡ªZZL
   4          ** ¹¤³Ì°æ±¾ £ºV1.0
   5          *********************************************************************************************************/
   6          #include "LCD1602.h"
   7          
   8          /*********************************************************************************************************
   9          ** º¯Êý¹¦ÄÜ £º¶ÁÐ´LCD1602Ê±ÓÃÓÚ¶ÁÐ´Ê±ÐòµÄÊ±ÖÓÑÓÊ±
  10          ** Èë¿Ú²ÎÊý £ºz£ºÑÓÊ±³¤¶È
  11          ** ³ö¿Ú²ÎÊý £ºÎÞ
  12          *********************************************************************************************************/
             -   
  13          void LCD_Delay(unsigned char z)
  14          {
  15   1        unsigned char x,y;
  16   1        for(x = z;x > 0;x --)
  17   1          for(y = 50;y>0;y--);
  18   1      }
  19          
  20          /*********************************************************************************************************
  21          ** º¯Êý¹¦ÄÜ £ºLCD1602Ã¦Âµ²éÑ¯
  22          ** º¯ÊýËµÃ÷ £ºÃ¿´Î¶ÁÐ´Òº¾§Ê±ÐèÒªÊÂÏÈ¼ì²âÐ¾Æ¬ÊÇ·ñ´¦ÓÚÃ¦Âµ×´Ì¬
  23          ** Èë¿Ú²ÎÊý £ºÎÞ
  24          ** ³ö¿Ú²ÎÊý £º·µ»ØÖµÎª1£ºµÈ´ý³¬Ê±
  25          **            ·µ»ØÖµÎª0£ºÐ¾Æ¬´¦ÓÚ¿ÕÏÐ×´Ì¬
  26          *********************************************************************************************************/
  27          unsigned char Check_1602_Busy(void)
  28          {
  29   1        unsigned int time=0;
  30   1        RS_1602 = 0;
  31   1        RW_1602 = 1;
  32   1        EN_1602 = 1;
  33   1        while( (LCD_PORT&0X80) != 0X00)
  34   1        {
  35   2          time ++;
  36   2          if(time > 1000) return 1;//Êµ¼Ê²âÁ¿»áÓöµ½ÓÐÐ©ÐÍºÅµÄÒº¾§BFÒ»Ö±Îª¸ß£¬Èç¹ûµÈ´ý³¬Ê±Ìø³öÑ­»· 
  37   2        } 
  38   1        return 0;
  39   1      }
  40          
  41          /*********************************************************************************************************
  42          ** º¯Êý¹¦ÄÜ £ºÏòÒº¾§Ð´ÈëÖ¸Áî
  43          ** º¯ÊýËµÃ÷ £º
  44          ** Èë¿Ú²ÎÊý £º´ýÐ´ÈëµÄÖ¸Áî
  45          ** ³ö¿Ú²ÎÊý £ºÎÞ
  46          *********************************************************************************************************/
  47          void Write_1602_Com(unsigned char zhiling)//Ð´Ö¸Áî
  48          {
  49   1        Check_1602_Busy();  //¶ÁÃ¦Âµ×´Ì¬£¬µÈ´ýÒº¾§´¦ÓÚ¿ÕÏÐ
  50   1        RS_1602 = 0;    //RS_1602ÎªµÍµçÆ½
  51   1        RW_1602 = 0;    //RW_1602ÎªµÍµçÆ½
  52   1        EN_1602 = 1;
  53   1        LCD_PORT = zhiling; //×¼±¸ºÃÊý¾Ý¿ÚµÄÊý¾Ý
C51 COMPILER V9.60.7.0   LCD1602                                                           04/21/2023 17:04:02 PAGE 2   

  54   1        LCD_Delay(1);   //¸ù¾ÝÊ±ÐòÒªÇó£¬ÑÓÊ±Ò»¶ÎÊ±¼ä£¬µÈ´ýÊý¾Ý¿ÚÊý¾ÝÎÈ¶¨
  55   1        EN_1602 = 0;    //²úÉúÒ»¸öÏÂ½µÑØ£¬½«Êý¾Ý¿ÚµÄÊý¾Ý¶ÁÈëµ½Òº¾§ÖÐ
  56   1        LCD_Delay(1);
  57   1      
  58   1      }
  59          
  60          /*********************************************************************************************************
  61          ** º¯Êý¹¦ÄÜ £ºÏòÒº¾§Ð´ÈëÊý¾Ý
  62          ** º¯ÊýËµÃ÷ £º
  63          ** Èë¿Ú²ÎÊý £º´ýÐ´ÈëµÄÊý¾Ý£¬Êý¾ÝÎªLCD1062ÓÃÀ´×öÏÔÊ¾ÓÃµÄ£¬±ÈÈçËµshuju = 0x30£¬ÔòÏÔÊ¾¡°0¡±£¬
  64          **        ÏÖ³ÉµÄ×Ö·ûÊý¾Ý¿É²éÑ¯"LCD1602Òº¾§ÍêÕûÖÐÎÄ×ÊÁÏ.pdf"ÖÐ¡°CGROMÖÐ×Ö·ûÂëÓë×Ö×Ö·û×ÖÄ£¹ØÏµ¶ÔÕÕ±í¡±
  65          ** ³ö¿Ú²ÎÊý £ºÎÞ
  66          *********************************************************************************************************/
  67          void Write_1602_Data(unsigned char shuju)//Ð´Êý¾Ý
  68          {
  69   1        Check_1602_Busy();
  70   1        RS_1602 = 1;
  71   1        RW_1602 = 0;
  72   1        EN_1602 = 1;
  73   1        LCD_PORT = shuju;
  74   1        LCD_Delay(1);
  75   1        EN_1602 = 0;  
  76   1        LCD_Delay(1);
  77   1      
  78   1      }
  79          
  80          /*********************************************************************************************************
  81          ** º¯Êý¹¦ÄÜ £ºÔÚÖ¸¶¨Î»ÖÃÁ¬ÐøÐ´ÈëÒ»´®×Ö·û
  82          ** º¯ÊýËµÃ÷ £º×¢ÒâÐ´Èë×Ö·û´®µÄ³¤¶È£¬²»Òª³¬¹ýÆÁÄ»µ¥ÐÐµÄÏÔÊ¾·¶Î§
  83          ** Èë¿Ú²ÎÊý £ºstr£º   ´ýÐ´Èë×Ö·û´®Ê×µØÖ·
  84          **            addr£º  Ð´ÈëÒº¾§ÏÔÊ¾µÄµØÖ·
  85          ** ³ö¿Ú²ÎÊý £ºÎÞ
  86          *********************************************************************************************************/
  87          void Write_1602_String(unsigned char *str,unsigned char addr)
  88          {
  89   1        Write_1602_Com(addr);
  90   1        while(*str)
  91   1        {
  92   2          Write_1602_Data(*str);
  93   2          str++;
  94   2        } 
  95   1      }
  96          
  97          /*********************************************************************************************************
  98          ** º¯Êý¹¦ÄÜ £ºÔÚÖ¸¶¨Î»ÖÃÐ´ÈëÒ»¸öÕûÊý
  99          ** º¯ÊýËµÃ÷ £ºÕûÊýµÄ·¶Î§´Ó0~65535£¬¸ü´óµÄÐèÒª²ÉÓÃlongÕûÐÍµÄ½øÐÐÀ©Õ¹£¬×¢ÒâÕûÊýµÄÎ»ÊýºÍµØÖ·²»Òª³¬³öÏÔÊ¾·¶Î§
 100          ** Èë¿Ú²ÎÊý £ºnumber£º´ýÐ´ÈëµÄÕûÊý
 101          **            addr£º  Ð´ÈëÒº¾§ÏÔÊ¾µÄµØÖ·
 102          ** ³ö¿Ú²ÎÊý £ºÎÞ
 103          *********************************************************************************************************/
 104          void Write_Num(unsigned int number,unsigned char addr)
 105          {
 106   1        Write_1602_Com(addr);
 107   1        if(number/10000 != 0)
 108   1        {
 109   2          Write_1602_Data(0x30 + number/10000);
 110   2          Write_1602_Data(0x30 + number%10000/1000);
 111   2          Write_1602_Data(0x30 + number%1000/100);
 112   2          Write_1602_Data(0x30 + number%100/10);
 113   2          Write_1602_Data(0x30 + number%10);
 114   2        } 
 115   1        else if(number/1000 != 0)
C51 COMPILER V9.60.7.0   LCD1602                                                           04/21/2023 17:04:02 PAGE 3   

 116   1        {
 117   2          Write_1602_Data(0x30 + number/1000);
 118   2          Write_1602_Data(0x30 + number%1000/100);
 119   2          Write_1602_Data(0x30 + number%100/10);
 120   2          Write_1602_Data(0x30 + number%10);  
 121   2        } 
 122   1        else if(number/100 != 0)
 123   1        {
 124   2          Write_1602_Data(0x30 + number/100);
 125   2          Write_1602_Data(0x30 + number%100/10);
 126   2          Write_1602_Data(0x30 + number%10);    
 127   2        }
 128   1        else if(number/10 != 0)
 129   1        {
 130   2          Write_1602_Data(0x30 + number/10);
 131   2          Write_1602_Data(0x30 + number%10);      
 132   2        }
 133   1        else Write_1602_Data(0x30 + number);
 134   1      }
 135          
 136          
 137          /*********************************************************************************************************
 138          ** º¯Êý¹¦ÄÜ £ºÒº¾§³õÊ¼»¯
 139          ** º¯ÊýËµÃ÷ £ºÓÃÒº¾§Ö®Ç°ÐèÒªÏÈ³õÊ¼»¯Òº¾§£¬ÅäÖÃ¶ÔÓ¦µÄÏÔÊ¾Ä£Ê½
 140          ** Èë¿Ú²ÎÊý £ºtime:ÐèÒªÑÓÊ±µÄÊ±¼ä£¬µ¥Î»ms
 141          ** ³ö¿Ú²ÎÊý £ºÎÞ
 142          *********************************************************************************************************/
 143          void LCD_1602_Init()//³õÊ¼»¯
 144          {
 145   1        Write_1602_Com(DISPLAY_MOD | DISPLAY_MOD_TWO_LINE | DISPLAY_MOD_5_7);//ÉèÖÃÏÔÊ¾Ä£Ê½£¬Á½ÐÐÏÔÊ¾£¬×Ö·ûµãÕó´ó
             -Ð¡Îª5*7:0X38
 146   1      
 147   1        Write_1602_Com(DISPLAY_SET | DISPLAY_SET_ON | DISPLAY_SET_CURSOR_OFF | DISPLEY_SET_BLINK_OFF);//¿ªÏÔÊ¾£¬²
             -»ÏÔÊ¾¹â±ê£¬¹â±ê²»ÉÁË¸:0X0F
 148   1          
 149   1        Write_1602_Com(SET_MOD | SET_MOD_AC_ADD | SET_MOD_MOVE_OFF);//ÉèÖÃÐ´ÈëÊý¾ÝºóÖ¸ÕëAC¼ÓÒ»,»­Ãæ²»¶¯£º0X06
 150   1      
 151   1        Write_1602_Com(CLEAR_SCREEN);//ÇåÆÁ
 152   1        Write_1602_Com(CURSOR_RESET);
 153   1        Write_1602_Com(0x80);
 154   1      }
 155          
 156          
 157          
 158          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    346    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
