
/***************************************************************************************************    
工程名称：	timer
功能描述：	定时器0实现1s定时，流水灯显示上的数据每秒加1
硬件连接：  用8位杜邦线将J8与J13连接
维护记录：  2011-8-22
***************************************************************************************************/
#include "time.h"
//*********************************************************************
//定时器0初始化   16位 10ms中断   可作为PCA时钟源（PWM）
//*********************************************************************
void Timer0_init(void)
{
	//AUXR = AUXR|0x80;  // T0, 1T Mode
	TMOD &= 0xF0;
	TMOD |= 0x01;	    
	TH0  = (65535-10000)/256;   //10ms
	TL0  = (65535-10000)%256;
	ET1  = 1;  //开启中断
	TR0  = 1;				
}

//*********************************************************************
//定时器1初始化  16位定时器 1ms 中断 //优先级3(最高)
//*********************************************************************
void Timer1_Init(void)
{
	TMOD &= 0x0F;
    TMOD |= 0x10;
	//AUXR = AUXR|0x40;  // T1, 1T Mode
	TH0  = (65535-1000)/256;   //1ms
	TL0  = (65535-1000)%256;
	//IPH |= 1<<3; //优先级设置
	//IP  |= 1<<3; //00最低，11最高
    EA = 1;
    ET1 = 1;
    TR1 = 1;
}

//void main(void)
//{
//    InitTimer1();
//}

void Timer0Interrupt(void) interrupt 1
{
	TH0  = (65535-10000)/256;   //10ms
	TL0  = (65535-10000)%256;
    //add your code here!
}

void Timer1Interrupt(void) interrupt 3
{
	TH0  = (65535-1000)/256;   //1ms
	TL0  = (65535-1000)%256;
    //add your code here!
}


